<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Georeferencing Aerial Imagery &mdash; QGIS Tutorials and Tips</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="QGIS Tutorials and Tips" href="../index.html" />
    <link rel="next" title="Karttadatan digitointi" href="digitizing_basics.html" />
    <link rel="prev" title="Georeferencing Topo Sheets and Scanned Maps" href="georeferencing_basics.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-690672-13', 'qgistutorials.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/logo.png">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Johdanto</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Teemme kartan</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Työskentely attribuuteilla</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Käytämme taulukkolaskenta- tai CSV tiedostoja</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Liitännäisiä käyttämään</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloading_osm_data.html">Searching and Downloading OpenStreetMap Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Perusteet vektorien muotoiluun</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Viivojen pituuksien laskenta ja tilastot</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Perustiedot rasterin muotoilusta ja analyysista</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Raster Mosaicing and Clipping</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Working with Terrain Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Working with WMS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Georeferencing Topo Sheets and Scanned Maps</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Georeferencing Aerial Imagery</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Karttadatan digitointi</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Performing Table Joins</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Performing Spatial Joins</a></li>
<li class="toctree-l1"><a class="reference internal" href="points_in_polygon.html">Pisteitä monikulmiossa analyysi</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Heatmap-kartan luonti</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Performing Spatial Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Nearest Neighbor Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Sampling Raster Data using Points or Polygons</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Eräkäsittely käyttäen Processing toimintoja</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_qgis_browser.html">Käytämme QGIS selainta</a></li>
<li class="toctree-l1"><a class="reference internal" href="counting_vertices.html">Tason verteksien lukumäärän laskenta</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_bil_bip_bsq_files.html">Open BIL, BIP or BSQ files in QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Getting Started With Python Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="find_neighbor_polygons.html">Find Neighbor Polygons in a Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="leaflet_maps_with_qgis2leaf.html">Leaflet Web Maps with qgis2leaf</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_gme_connector.html">Using Google Maps Engine Connector for QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_resources.html">QGIS oppimisen resurssit</a></li>
<li class="toctree-l1"><a class="reference internal" href="teach_qgis.html">QGIS koulutuksessa</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Tietojen käyttö</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="georeferencing_basics.html" title="Previous Chapter: Georeferencing Topo Sheets and Scanned Maps"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Georeferencing T...</span>
    </a>
  </li>
  <li>
    <a href="digitizing_basics.html" title="Next Chapter: Karttadatan digitointi"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Karttadatan digi... &raquo;</span>
    </a>
  </li>
              
            
            

            
<form role="form" class="navbar-form navbar-right">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="ro">Romanian</option>
  <option value="fi_FI">Finnish</option>
  <option value="it">Italian</option>
  <option value="nl">Dutch</option>
  <option value="es">Spanish</option>
  <option value="ru">Russian</option>
  <option value="pt_BR">Portuguese</option>
  <option value="fr">French</option>
</select>
</form>

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<div class="g-person" data-width="250" data-href="//plus.google.com/u/0/116912222767108657277" data-showtagline="false" data-showcoverphoto="false" data-rel="author"></div>

<!-- AddThis Button BEGIN -->
<h4>Share</h4>
<div class="addthis_toolbox addthis_default_style addthis_32x32_style">
    <a class="addthis_button_google_plusone_share"></a>
    <a class="addthis_button_twitter"></a>
    <a class="addthis_button_facebook"></a>
    <a class="addthis_button_email"></a>
    <a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<!-- AddThis Button END -->
        </div>
      </div>
    <div class="col-md-9">
      

  <div class="section" id="georeferencing-aerial-imagery">
<h1>Georeferencing Aerial Imagery<a class="headerlink" href="#georeferencing-aerial-imagery" title="Permalink to this headline">¶</a></h1>
<p>[ Download PDF <a class="reference external" href="../pdf/advanced_georeferencing_a4.pdf">A4</a>
<a class="reference external" href="../pdf/advanced_georeferencing_letter.pdf">Letter</a> ]</p>
<p>Oppaassa <a class="reference internal" href="georeferencing_basics.html"><em>Georeferencing Topo Sheets and Scanned Maps</em></a>  tarkastelemme georeferoinnin perusmenettelyä QGIS:ssa. Tuohon menetelmäään sisältyi koordinaattien lukeminen skannatusta kartasta ja niiden syöttäminen manuaalisesti. Usein ei kuitenkaan ole koordinaatteja tulostetussa kartassa tai yrität georeferoida kuvaa. Tässä tapauksessa voit käyttää toista georeferoitua aineistoa lähteenä. Tässä oppaassa opit kuinka käyttää avaoimen datan lähteitä georeferointi prosessissa.</p>
<div class="section" id="overview-of-the-task">
<h2>Katsaus tehtävään<a class="headerlink" href="#overview-of-the-task" title="Permalink to this headline">¶</a></h2>
<p>Georeferoimme korkearesoluutioista ilmapallokuvaa käyttäen koordinaatteja OpenStreeMap:sta.</p>
<div class="section" id="other-skills-you-will-learn">
<h3>Muita taitoja joita tulet oppimaan<a class="headerlink" href="#other-skills-you-will-learn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="first">Super korkearesoluutioden avoimen kuvaianeiston lataaminen.</p>
</li>
<li><p class="first">OpenLayers liitännäisen käyttö QGIS:ssä.</p>
</li>
<li><p class="first">Koordinaattien konvertointi eri projektioiden välillä käyttäen <strong>cs2cs</strong> komentotulkki työkalua.</p>
</li>
<li><p class="first">Olemassa olevan georeferoidun tason käyttö GCP pisteiden lähteenä Georeferointi työkalussa.</p>
</li>
<li><p class="first">Räätälöidyn no-data arvon asettaminen tasolle.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="get-the-data">
<h2>Hanki tiedot<a class="headerlink" href="#get-the-data" title="Permalink to this headline">¶</a></h2>
<p>Tässä oppaassa käytämme eräitä upaeita leija ja ilmapallo kuvia joita <a class="reference external" href="http://publiclaboratory.org/archive">The Public Laboratory</a> on koonnut. Heiltä on tarjolla myös kuvien georeferoituja versioita, mutta me lataamme georeferoimattomat veriot ja georeferoimme ne QGIS:ssä käyden prosessin läpi. Jos pidät heidän tarjoamista kuvista, voit <a class="reference external" href="http://google-latlong.blogspot.in/2012/04/balloon-and-kite-imagery-in-google.html">tutkia niitä</a> myös Google Earth:ssa.</p>
<p>Lataa <a class="reference external" href="http://publiclaboratory.org/map/washington-square-park-new-york-new-york/2012-10-01">Washington Square Park, New York</a> JPG kuva. Voit myös klikata oikealla JPG näppäintä ja valita <em class="guilabel">Tallenna kohde levylle...</em>.</p>
</div>
<div class="section" id="procedure">
<h2>Menettely<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>For this tutorial, we will be using the OpenStreetMap layer as our reference
layer. Install the OpenLayers plugin from <em class="menuselection">Plugins ‣ Manage
and install plugins ‣ Get more</em>. See <a class="reference internal" href="using_plugins.html"><em>Liitännäisiä käyttämään</em></a> for more
information on using plugins in QGIS.</li>
</ol>
<img alt="../_images/1.png" class="align-center" src="../_images/1.png" />
<ol class="arabic simple" start="2">
<li>Once installed, go to <em class="menuselection">Plugins ‣ OpenLayers plugin ‣ Add
OpenStreetMap layer</em>. This will add a layer of pre-rendered tiles created
from <a class="reference external" href="http://www.openstreetmap.org/">OpenStreetMap data</a>.</li>
</ol>
<img alt="../_images/2.png" class="align-center" src="../_images/2.png" />
<ol class="arabic simple" start="3">
<li>Now you have the OpenStreetMap layer loaded in QGIS. Note the Coordinate
Reference System (CRS) for this layer. It is set as EPSG 3857 Pseudo
Mercator. This is important to note, since the coordinates we infer from
this layer will be in this CRS.</li>
</ol>
<img alt="../_images/3.png" class="align-center" src="../_images/3.png" />
<ol class="arabic simple" start="4">
<li>Now the task is to locate the general vicinity of the area that we are
trying to georeference. You can just use Pan and Zoom tools to locate that
area on the OpenStreetMap layer. But we can take this opportunity to
demonstrate another tool that may help you in future. We know that the image
we downloaded is for Washington Square Park in New York. If you search for
that place, you will be able to locate the wikipedia page for it. The
coordinates for the park are listed there.</li>
</ol>
<img alt="../_images/4.png" class="align-center" src="../_images/4.png" />
<ol class="arabic simple" start="5">
<li>You will notice that the coordinates are in Degrees/Minute/Seconds and are
Latitude and Longitude. But since our layer is in Mercator projection, we
will need Mercator coordinates to locate the park. Here’s where a
command-line tool called <strong>cs2cs</strong> comes handy. If you have installed QGIS
from OSGeo4W installer, you will already have it installed on your system.
On Linux and Mac too, it comes pre-installed with QGIS. Launch a terminal
window and type <tt class="docutils literal"><span class="pre">cs2cs</span></tt> to check if it is available. Windows users can find
a terminal at <em class="menuselection">Start ‣ OSGeo4W ‣ MSYS</em>.</li>
</ol>
<img alt="../_images/5.png" class="align-center" src="../_images/5.png" />
<ol class="arabic simple" start="6">
<li>Once you have verified that the cs2cs tool exists on your system, it is time
to convert out Latitude and Longitude to Mercator coordinates. The way this
tool works is that you need to specify a <em class="guilabel">source</em> and
<em class="guilabel">destination</em> CRS. The CRS definition could be a <a class="reference external" href="http://trac.osgeo.org/proj/wiki/GenParms">PROJ4 string</a> or an <a class="reference external" href="http://www.epsg-registry.org/">EPSG code</a>. Since we already know the EPSG code for
out input and output CRS, we will use this. The simplest way to use the tool
is to supply the input coordinates on the command line itself. Note that the
tool accepts coordinates in the order <cite>X Y</cite>, so we need to enter <cite>Longitude
Latitude</cite>. Enter the following command in the terminal and press Enter. Note
that we need to escape the quotes (&#8221;) with a backslash (\). Once you press
enter, you will see the tool process the coordinates and print out output X Y
coordinates in EPSG 3857 CRS.</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre>echo &quot;-73d59&#39;51\&quot; 40d43&#39;51\&quot;&quot; | cs2cs +init=EPSG:4326 +to +init=EPSG:3857

-8237364.02 4972720.34 0.00
</pre></div>
</div>
<img alt="../_images/6.png" class="align-center" src="../_images/6.png" />
<ol class="arabic simple" start="7">
<li>Copy these coordinates and switch to QGIS. At the bottom of the QGIS window,
you will see a textbox labeled Coordinates. Enter the coordinates there in
X,Y form. Press Enter.  You will see the map shift a bit, but not zoom. To
zoom to the area, select 1:2500 scale from the Scale drop-down next to the
Coordinate box and press Enter.</li>
</ol>
<img alt="../_images/7.png" class="align-center" src="../_images/7.png" />
<ol class="arabic simple" start="8">
<li>Voila! you now see Washington Square Park area on your canvas. Now it is
time to start georeferencing. Launch the <strong>Georeferencer</strong> from
<em class="menuselection">Raster ‣ Georeferencer ‣ Georeferencer</em>. If you do not
see that menu item, you will need to enable the <em class="guilabel">Georeferencer
GDAL</em> plugin from <em class="menuselection">Plugins ‣ Manage and install Plugins ‣
Installed</em>.</li>
</ol>
<img alt="../_images/8.png" class="align-center" src="../_images/8.png" />
<ol class="arabic simple" start="9">
<li>In the <em class="guilabel">Georeferencer</em> window, go to <em class="menuselection">File ‣ Open
raster</em>. Navigate to the downloaded JPG file and click <em class="guilabel">Open</em>.</li>
</ol>
<img alt="../_images/9.png" class="align-center" src="../_images/9.png" />
<ol class="arabic simple" start="10">
<li>In the <em class="guilabel">Coordinate Reference System Selector</em>,
choose <em class="guilabel">EPSG:3857 Pseudo Mercator</em></li>
</ol>
<img alt="../_images/10.png" class="align-center" src="../_images/10.png" />
<ol class="arabic simple" start="11">
<li>Now click on the <em class="guilabel">Add Point</em> button on the toolbar and select an easily
identifiable location on the image. Corners, intersections, poles etc. make
good control points.</li>
</ol>
<img alt="../_images/11.png" class="align-center" src="../_images/11.png" />
<ol class="arabic simple" start="12">
<li>Once you click on the image at a control point location, you will see a
pop-up asking you to enter map coordinates. Click the button
<em class="guilabel">From map canvas</em>.</li>
</ol>
<img alt="../_images/12.png" class="align-center" src="../_images/12.png" />
<ol class="arabic simple" start="13">
<li>Find the same location in your reference layer, i.e. the OpenStreetMap
layer and click there. The coordinates are auto-populated from your click
on the map canvas. Click Ok. Similarly, choose at least 4 points on the
image and add their coordinates from the reference layer.</li>
</ol>
<img alt="../_images/13.png" class="align-center" src="../_images/13.png" />
<ol class="arabic simple" start="14">
<li>Now go to <em class="menuselection">Settings ‣ Transformation settings.</em></li>
</ol>
<img alt="../_images/14.png" class="align-center" src="../_images/14.png" />
<ol class="arabic simple" start="15">
<li>Choose the settings as shown below. Make sure you the <em class="guilabel">Load in
QGIS when done</em> button is checked. Click OK. Back in the
<em class="guilabel">Georeferencer</em> window, go to <em class="menuselection">File ‣
Start georeferencing</em>. This will start the process of warping the image
using the GCPs and creating the target raster.</li>
</ol>
<img alt="../_images/15.png" class="align-center" src="../_images/15.png" />
<ol class="arabic simple" start="16">
<li>Once the process finishes, you will see the georeferenced layer loaded in
QGIS. If all went well, you will see it nicely overlay the OpenStreetMap
layer.</li>
</ol>
<img alt="../_images/16.png" class="align-center" src="../_images/16.png" />
<ol class="arabic simple" start="17">
<li>To make our output look nicer, let’s remove the black and white no-data
values. Right click on the image layer and choose <em class="guilabel">Properties</em>.</li>
</ol>
<img alt="../_images/17.png" class="align-center" src="../_images/17.png" />
<ol class="arabic simple" start="18">
<li>Switch to the <em class="guilabel">Transparency</em> tab. We want to indicate that any
black or white pixels in the image are <cite>no-data</cite> values and should be made
transparent. Input 0 as the <em class="guilabel">No data value</em>. Also, in the
<em class="guilabel">Custom transparency options</em>, click the <em class="guilabel">+</em> button and
add 255 as the transparent pixels for each band and enter 100 as the
:<em class="guilabel">Percent transparent</em>. Click <em class="guilabel">OK</em>.</li>
</ol>
<img alt="../_images/18.png" class="align-center" src="../_images/18.png" />
<ol class="arabic simple" start="19">
<li>Now you will see your georeferenced image nicely overlaid on the base layer.</li>
</ol>
<img alt="../_images/19.png" class="align-center" src="../_images/19.png" />
</div>
</div>



  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013, Ujaval Gandhi.<br/>
      Last updated on Sep 30, 2014.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
<!-- Google+ Badge -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=spatialthoughts"></script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/advanced_georeferencing.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>